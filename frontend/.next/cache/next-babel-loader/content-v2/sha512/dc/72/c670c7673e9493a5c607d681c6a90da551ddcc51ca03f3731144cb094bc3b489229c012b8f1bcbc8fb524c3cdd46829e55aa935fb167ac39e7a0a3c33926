{"ast":null,"code":"var _jsxFileName = \"/home/node/app/pages/posts/pages/[page].tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from \"../../../components/Layout\";\nimport { initializeApollo, addApolloState } from \"../../../lib/apolloClient\";\nimport { gql } from \"@apollo/client\";\nimport { useRouter } from \"next/router\";\nimport PostsList, { ITEMS_PER_PAGE } from \"../../../components/PostsList\";\nimport { MENU_QUERY } from \"../../../components/Navbar\";\nexport const POSTS_QUERY = gql`\n  query postsQuery($first: Int, $last: Int, $after: String, $before: String) {\n    posts(first: $first, last: $last, after: $after, before: $before) {\n      edges {\n        node {\n          date\n          featuredImage {\n            title\n            sourceUrl\n          }\n          title\n          author {\n            id\n          }\n          id\n          slug\n          excerpt\n        }\n      }\n    }\n  }\n`;\nexport const CURSORS_QUERY = gql`\n  query IDQuery {\n    posts {\n      edges {\n        cursor\n      }\n    }\n  }\n`;\n\nconst IndexPage = ({\n  posts,\n  errors,\n  numOfPages,\n  menuListItems\n}) => {\n  const router = useRouter();\n  const pageNumber = parseInt(router.query.page.toString());\n\n  if (errors) {\n    return __jsx(Layout, {\n      title: \"Error | Next.js + TypeScript Example\",\n      menuListItems: menuListItems,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 7\n      }\n    }, __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }\n    }, __jsx(\"span\", {\n      style: {\n        color: \"red\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }\n    }, \"Error:\"), \" \", errors));\n  }\n\n  return __jsx(Layout, {\n    title: \"Home | Next.js + TypeScript Example\",\n    menuListItems: menuListItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, __jsx(PostsList, {\n    curDir: \"..\",\n    posts: posts,\n    pageNumber: pageNumber,\n    numOfPages: numOfPages,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default IndexPage;\nexport const getStaticPaths = async () => {\n  const apolloClient = initializeApollo();\n  const {\n    data\n  } = await apolloClient.query({\n    query: CURSORS_QUERY,\n    context: {\n      clientName: \"wordPress\"\n    }\n  });\n  let paths = [];\n  const numOfPages = Math.ceil(data.posts.edges.length / ITEMS_PER_PAGE);\n\n  for (let i = 1; i <= numOfPages; i++) {\n    paths.push({\n      params: {\n        page: i.toString()\n      }\n    });\n  }\n\n  return {\n    paths,\n    fallback: false\n  };\n};\nexport const getStaticProps = async ({\n  params\n}) => {\n  try {\n    const page = parseInt(params === null || params === void 0 ? void 0 : params.page);\n    const apolloClient = initializeApollo();\n    const cursors = await apolloClient.query({\n      query: CURSORS_QUERY,\n      context: {\n        clientName: \"wordPress\"\n      }\n    }).then(res => [res.data.posts.edges[0], ...res.data.posts.edges.filter((_, index) => (index + 1) % ITEMS_PER_PAGE === 0)]);\n    const {\n      data\n    } = await apolloClient.query({\n      query: POSTS_QUERY,\n      variables: {\n        first: ITEMS_PER_PAGE,\n        last: null,\n        after: page === 1 ? null : cursors[page - 1].cursor,\n        before: null\n      },\n      context: {\n        clientName: \"wordPress\"\n      }\n    });\n    const menuListItems = await apolloClient.query({\n      query: MENU_QUERY,\n      context: {\n        clientName: \"wordPress\"\n      }\n    }).then(res => res.data.headerMenu.map(item => ({\n      title: item.label,\n      pageURL: item.url\n    })));\n    let posts = data.posts.edges.map(edge => {\n      edge.node.featuredImage.sourceURL = edge.node.featuredImage.sourceURL.replace(\"localhost\", \"192.168.0.19\");\n      return edge.node;\n    });\n    console.log(data.posts.edges[0].node.featuredImage.sourceURL);\n    return addApolloState(apolloClient, {\n      props: {\n        posts,\n        numOfPages: cursors.length,\n        menuListItems\n      }\n    });\n  } catch (err) {\n    return {\n      props: {\n        errors: err.message\n      }\n    };\n  }\n};","map":{"version":3,"sources":["/home/node/app/pages/posts/pages/[page].tsx"],"names":["Layout","initializeApollo","addApolloState","gql","useRouter","PostsList","ITEMS_PER_PAGE","MENU_QUERY","POSTS_QUERY","CURSORS_QUERY","IndexPage","posts","errors","numOfPages","menuListItems","router","pageNumber","parseInt","query","page","toString","color","getStaticPaths","apolloClient","data","context","clientName","paths","Math","ceil","edges","length","i","push","params","fallback","getStaticProps","cursors","then","res","filter","_","index","variables","first","last","after","cursor","before","headerMenu","map","item","title","label","pageURL","url","edge","node","featuredImage","sourceURL","replace","console","log","props","err","message"],"mappings":";;;AAAA,OAAOA,MAAP,MAAmB,4BAAnB;AACA,SAASC,gBAAT,EAA2BC,cAA3B,QAAiD,2BAAjD;AACA,SAASC,GAAT,QAAoB,gBAApB;AAEA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAOC,SAAP,IAAoBC,cAApB,QAA0C,+BAA1C;AAEA,SAASC,UAAT,QAAyC,4BAAzC;AAEA,OAAO,MAAMC,WAAW,GAAGL,GAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CArBO;AA8BP,OAAO,MAAMM,aAAa,GAAGN,GAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CARO;;AAUP,MAAMO,SAAS,GAAG,CAAC;AAAEC,EAAAA,KAAF;AAASC,EAAAA,MAAT;AAAiBC,EAAAA,UAAjB;AAA6BC,EAAAA;AAA7B,CAAD,KAAyD;AACzE,QAAMC,MAAM,GAAGX,SAAS,EAAxB;AACA,QAAMY,UAAU,GAAGC,QAAQ,CAACF,MAAM,CAACG,KAAP,CAAaC,IAAb,CAAkBC,QAAlB,EAAD,CAA3B;;AAEA,MAAIR,MAAJ,EAAY;AACV,WACE,MAAC,MAAD;AACE,MAAA,KAAK,EAAC,sCADR;AAEE,MAAA,aAAa,EAAEE,aAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAM,MAAA,KAAK,EAAE;AAAEO,QAAAA,KAAK,EAAE;AAAT,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,OACgDT,MADhD,CAJF,CADF;AAUD;;AACD,SACE,MAAC,MAAD;AACE,IAAA,KAAK,EAAC,qCADR;AAEE,IAAA,aAAa,EAAEE,aAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIE,MAAC,SAAD;AACE,IAAA,MAAM,EAAC,IADT;AAEE,IAAA,KAAK,EAAEH,KAFT;AAGE,IAAA,UAAU,EAAEK,UAHd;AAIE,IAAA,UAAU,EAAEH,UAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,CADF;AAaD,CA7BD;;AA+BA,eAAeH,SAAf;AAEA,OAAO,MAAMY,cAA8B,GAAG,YAAY;AACxD,QAAMC,YAAY,GAAGtB,gBAAgB,EAArC;AAEA,QAAM;AAAEuB,IAAAA;AAAF,MAAW,MAAMD,YAAY,CAACL,KAAb,CAAmB;AACxCA,IAAAA,KAAK,EAAET,aADiC;AAExCgB,IAAAA,OAAO,EAAE;AAAEC,MAAAA,UAAU,EAAE;AAAd;AAF+B,GAAnB,CAAvB;AAIA,MAAIC,KAAK,GAAG,EAAZ;AACA,QAAMd,UAAU,GAAGe,IAAI,CAACC,IAAL,CAAUL,IAAI,CAACb,KAAL,CAAWmB,KAAX,CAAiBC,MAAjB,GAA0BzB,cAApC,CAAnB;;AACA,OAAK,IAAI0B,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAInB,UAArB,EAAiCmB,CAAC,EAAlC,EAAsC;AACpCL,IAAAA,KAAK,CAACM,IAAN,CAAW;AAAEC,MAAAA,MAAM,EAAE;AAAEf,QAAAA,IAAI,EAAEa,CAAC,CAACZ,QAAF;AAAR;AAAV,KAAX;AACD;;AAED,SAAO;AAAEO,IAAAA,KAAF;AAASQ,IAAAA,QAAQ,EAAE;AAAnB,GAAP;AACD,CAdM;AAgBP,OAAO,MAAMC,cAA8B,GAAG,OAAO;AAAEF,EAAAA;AAAF,CAAP,KAAsB;AAClE,MAAI;AACF,UAAMf,IAAI,GAAGF,QAAQ,CAACiB,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAEf,IAAT,CAArB;AACA,UAAMI,YAAY,GAAGtB,gBAAgB,EAArC;AAEA,UAAMoC,OAAO,GAAG,MAAMd,YAAY,CAC/BL,KADmB,CACb;AACLA,MAAAA,KAAK,EAAET,aADF;AAELgB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,UAAU,EAAE;AAAd;AAFJ,KADa,EAKnBY,IALmB,CAKbC,GAAD,IAAS,CACbA,GAAG,CAACf,IAAJ,CAASb,KAAT,CAAemB,KAAf,CAAqB,CAArB,CADa,EAEb,GAAGS,GAAG,CAACf,IAAJ,CAASb,KAAT,CAAemB,KAAf,CAAqBU,MAArB,CACD,CAACC,CAAD,EAAYC,KAAZ,KAA8B,CAACA,KAAK,GAAG,CAAT,IAAcpC,cAAd,KAAiC,CAD9D,CAFU,CALK,CAAtB;AAYA,UAAM;AAAEkB,MAAAA;AAAF,QAAW,MAAMD,YAAY,CAACL,KAAb,CAAmB;AACxCA,MAAAA,KAAK,EAAEV,WADiC;AAExCmC,MAAAA,SAAS,EAAE;AACTC,QAAAA,KAAK,EAAEtC,cADE;AAETuC,QAAAA,IAAI,EAAE,IAFG;AAGTC,QAAAA,KAAK,EAAE3B,IAAI,KAAK,CAAT,GAAa,IAAb,GAAoBkB,OAAO,CAAClB,IAAI,GAAG,CAAR,CAAP,CAAkB4B,MAHpC;AAITC,QAAAA,MAAM,EAAE;AAJC,OAF6B;AAQxCvB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,UAAU,EAAE;AAAd;AAR+B,KAAnB,CAAvB;AAWA,UAAMZ,aAAa,GAAG,MAAMS,YAAY,CACrCL,KADyB,CACnB;AACLA,MAAAA,KAAK,EAAEX,UADF;AAELkB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,UAAU,EAAE;AAAd;AAFJ,KADmB,EAKzBY,IALyB,CAKnBC,GAAD,IACJA,GAAG,CAACf,IAAJ,CAASyB,UAAT,CAAoBC,GAApB,CACGC,IAAD,KAAyD;AACvDC,MAAAA,KAAK,EAAED,IAAI,CAACE,KAD2C;AAEvDC,MAAAA,OAAO,EAAEH,IAAI,CAACI;AAFyC,KAAzD,CADF,CANwB,CAA5B;AAcA,QAAI5C,KAAK,GAAGa,IAAI,CAACb,KAAL,CAAWmB,KAAX,CAAiBoB,GAAjB,CAAsBM,IAAD,IAA0B;AACzDA,MAAAA,IAAI,CAACC,IAAL,CAAUC,aAAV,CAAwBC,SAAxB,GAAoCH,IAAI,CAACC,IAAL,CAAUC,aAAV,CAAwBC,SAAxB,CAAkCC,OAAlC,CAClC,WADkC,EAElC,cAFkC,CAApC;AAKA,aAAOJ,IAAI,CAACC,IAAZ;AACD,KAPW,CAAZ;AASAI,IAAAA,OAAO,CAACC,GAAR,CAAYtC,IAAI,CAACb,KAAL,CAAWmB,KAAX,CAAiB,CAAjB,EAAoB2B,IAApB,CAAyBC,aAAzB,CAAuCC,SAAnD;AACA,WAAOzD,cAAc,CAACqB,YAAD,EAAe;AAClCwC,MAAAA,KAAK,EAAE;AACLpD,QAAAA,KADK;AAELE,QAAAA,UAAU,EAAEwB,OAAO,CAACN,MAFf;AAGLjB,QAAAA;AAHK;AAD2B,KAAf,CAArB;AAOD,GA1DD,CA0DE,OAAOkD,GAAP,EAAY;AACZ,WAAO;AAAED,MAAAA,KAAK,EAAE;AAAEnD,QAAAA,MAAM,EAAEoD,GAAG,CAACC;AAAd;AAAT,KAAP;AACD;AACF,CA9DM","sourcesContent":["import Layout from \"../../../components/Layout\";\nimport { initializeApollo, addApolloState } from \"../../../lib/apolloClient\";\nimport { gql } from \"@apollo/client\";\nimport { GetStaticPaths, GetStaticProps } from \"next\";\nimport { useRouter } from \"next/router\";\nimport PostsList, { ITEMS_PER_PAGE } from \"../../../components/PostsList\";\nimport { Post } from \"../../../interfaces\";\nimport { MENU_QUERY, MenuListItem } from \"../../../components/Navbar\";\n\nexport const POSTS_QUERY = gql`\n  query postsQuery($first: Int, $last: Int, $after: String, $before: String) {\n    posts(first: $first, last: $last, after: $after, before: $before) {\n      edges {\n        node {\n          date\n          featuredImage {\n            title\n            sourceUrl\n          }\n          title\n          author {\n            id\n          }\n          id\n          slug\n          excerpt\n        }\n      }\n    }\n  }\n`;\n\ntype Props = {\n  posts?: Post[];\n  errors?: string;\n  numOfPages: number;\n  menuListItems: MenuListItem[];\n};\n\nexport const CURSORS_QUERY = gql`\n  query IDQuery {\n    posts {\n      edges {\n        cursor\n      }\n    }\n  }\n`;\n\nconst IndexPage = ({ posts, errors, numOfPages, menuListItems }: Props) => {\n  const router = useRouter();\n  const pageNumber = parseInt(router.query.page.toString());\n\n  if (errors) {\n    return (\n      <Layout\n        title=\"Error | Next.js + TypeScript Example\"\n        menuListItems={menuListItems}\n      >\n        <p>\n          <span style={{ color: \"red\" }}>Error:</span> {errors}\n        </p>\n      </Layout>\n    );\n  }\n  return (\n    <Layout\n      title=\"Home | Next.js + TypeScript Example\"\n      menuListItems={menuListItems}\n    >\n      <PostsList\n        curDir=\"..\"\n        posts={posts!}\n        pageNumber={pageNumber}\n        numOfPages={numOfPages}\n      />\n    </Layout>\n  );\n};\n\nexport default IndexPage;\n\nexport const getStaticPaths: GetStaticPaths = async () => {\n  const apolloClient = initializeApollo();\n\n  const { data } = await apolloClient.query({\n    query: CURSORS_QUERY,\n    context: { clientName: \"wordPress\" },\n  });\n  let paths = [];\n  const numOfPages = Math.ceil(data.posts.edges.length / ITEMS_PER_PAGE);\n  for (let i = 1; i <= numOfPages; i++) {\n    paths.push({ params: { page: i.toString() } });\n  }\n\n  return { paths, fallback: false };\n};\n\nexport const getStaticProps: GetStaticProps = async ({ params }) => {\n  try {\n    const page = parseInt(params?.page! as string);\n    const apolloClient = initializeApollo();\n\n    const cursors = await apolloClient\n      .query({\n        query: CURSORS_QUERY,\n        context: { clientName: \"wordPress\" },\n      })\n      .then((res) => [\n        res.data.posts.edges[0],\n        ...res.data.posts.edges.filter(\n          (_: string, index: number) => (index + 1) % ITEMS_PER_PAGE === 0\n        ),\n      ]);\n\n    const { data } = await apolloClient.query({\n      query: POSTS_QUERY,\n      variables: {\n        first: ITEMS_PER_PAGE,\n        last: null,\n        after: page === 1 ? null : cursors[page - 1].cursor,\n        before: null,\n      },\n      context: { clientName: \"wordPress\" },\n    });\n\n    const menuListItems = await apolloClient\n      .query({\n        query: MENU_QUERY,\n        context: { clientName: \"wordPress\" },\n      })\n      .then((res) =>\n        res.data.headerMenu.map(\n          (item: { url: string; label: string; type: string }) => ({\n            title: item.label,\n            pageURL: item.url,\n          })\n        )\n      );\n\n    let posts = data.posts.edges.map((edge: { node: Post }) => {\n      edge.node.featuredImage.sourceURL = edge.node.featuredImage.sourceURL.replace(\n        \"localhost\",\n        \"192.168.0.19\"\n      );\n\n      return edge.node;\n    });\n\n    console.log(data.posts.edges[0].node.featuredImage.sourceURL);\n    return addApolloState(apolloClient, {\n      props: {\n        posts,\n        numOfPages: cursors.length,\n        menuListItems,\n      },\n    });\n  } catch (err) {\n    return { props: { errors: err.message } };\n  }\n};\n"]},"metadata":{},"sourceType":"module"}